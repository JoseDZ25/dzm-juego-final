
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>DZM Shooter M√≥vil - Bucio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { margin: 0; background: #000; overflow: hidden; }
    canvas { display: block; margin: 0 auto; background: #111; }
    .controls {
      position: fixed;
      bottom: 10px;
      width: 100%;
      display: flex;
      justify-content: space-around;
      z-index: 10;
    }
    .btn {
      background: rgba(255,255,255,0.2);
      border: 2px solid #fff;
      color: white;
      font-size: 20px;
      padding: 15px;
      border-radius: 10px;
      width: 80px;
      text-align: center;
      user-select: none;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<div class="controls">
  <div class="btn" id="left">‚óÄÔ∏è</div>
  <div class="btn" id="shoot">üî´</div>
  <div class="btn" id="right">‚ñ∂Ô∏è</div>
</div>

<audio id="bgm" src="https://www.bensound.com/bensound-music/bensound-epic.mp3" loop></audio>
<audio id="shootSound" src="https://actions.google.com/sounds/v1/foley/punch_soft_impact.ogg"></audio>
<audio id="explodeSound" src="https://actions.google.com/sounds/v1/explosions/explosion.ogg"></audio>

<button id="restartBtn" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
padding:20px; font-size:20px; background:#fff; border-radius:10px; border:2px solid #000; z-index:20;">
üîÑ Jugar de nuevo
</button>

<button id="musicBtn" style="position:fixed; top:10px; right:10px; padding:10px; font-size:14px;
background:#444; color:#fff; border:none; border-radius:8px; z-index:20;">üîä M√∫sica</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight - 100;

let player = { x: canvas.width / 2 - 25, y: canvas.height - 60, width: 50, height: 20, speed: 5 };
let bullets = [];
let enemies = [];
let bonuses = [];
let enemyCount = 0;
let bonusCollected = 0;
let gameOver = false;
let gameWon = false;
let keys = {};
let touchLeft = false, touchRight = false, touchShoot = false;

const bonusWords = [
  "ADS", "ITO", "Cobertura", "Efectividad", "volumen", "Cr√©ditos", "Combos",
  "Promo mes", "PDV Grandes", "PDV Medianos", "PDV B√°sicos", "Firmas Autorizadas",
  "Medidas seguridad", "Marcas estrat√©gicas", "Cobranza al 100"
];

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

document.getElementById("left").addEventListener("touchstart", () => touchLeft = true);
document.getElementById("left").addEventListener("touchend", () => touchLeft = false);
document.getElementById("right").addEventListener("touchstart", () => touchRight = true);
document.getElementById("right").addEventListener("touchend", () => touchRight = false);
document.getElementById("shoot").addEventListener("touchstart", () => touchShoot = true);
document.getElementById("shoot").addEventListener("touchend", () => touchShoot = false);

const bgm = document.getElementById("bgm");
const musicBtn = document.getElementById("musicBtn");
const shootSound = document.getElementById("shootSound");
const explodeSound = document.getElementById("explodeSound");

let musicOn = true;
musicBtn.addEventListener("click", () => {
  musicOn = !musicOn;
  if (musicOn) {
    bgm.play();
    musicBtn.textContent = "üîä M√∫sica";
  } else {
    bgm.pause();
    musicBtn.textContent = "üîá Silencio";
  }
});
document.getElementById("restartBtn").addEventListener("click", () => location.reload());
setTimeout(() => { bgm.play().catch(() => { musicBtn.textContent = "‚ñ∂Ô∏è Activar m√∫sica"; }); }, 1000);


function playShoot() {
  const s = shootSound.cloneNode();
  s.volume = 0.5;
  s.play().catch(() => {});
}
function playExplosion() {
  const e = explodeSound.cloneNode();
  e.volume = 0.7;
  e.play().catch(() => {});
}


function drawPlayer() {
  ctx.fillStyle = "#00f";
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawBullets() {
  ctx.fillStyle = "#fff";
  bullets.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));
}

function drawEnemies() {
  ctx.fillStyle = "red";
  enemies.forEach(e => {
    ctx.beginPath();
    ctx.arc(e.x, e.y, e.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawBonuses() {
  ctx.fillStyle = "yellow";
  ctx.font = "12px Arial";
  bonuses.forEach(b => {
    ctx.fillRect(b.x, b.y, b.size, b.size);
    ctx.fillStyle = "black";
    ctx.fillText(b.word, b.x + 2, b.y + b.size / 2);
    ctx.fillStyle = "yellow";
  });
}

function drawUI() {
  ctx.fillStyle = "#fff";
  ctx.font = "14px Arial";
  ctx.fillText("Enemigos eliminados: " + (enemyCount - enemies.length) + " / 100", 10, 20);
  ctx.fillText("Bonus recogidos: " + bonusCollected + " / " + bonusWords.length, 10, 40);
}

function drawGameOver() {
  ctx.fillStyle = "rgba(0,0,0,0.7)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#f00";
  ctx.font = "40px Arial";
  ctx.fillText("¬°Game Over!", canvas.width / 2 - 120, canvas.height / 2);
  ctx.font = "16px Arial";
  ctx.fillStyle = "#fff";
  ctx.fillText("Creado por Bucio", canvas.width / 2 - 80, canvas.height / 2 + 40);
  
  
  document.getElementById("restartBtn").style.display = "none";

  const endTime = Date.now();
  const duration = Math.floor((endTime - startTime) / 1000);
  const date = new Date().toLocaleString();
  const container = document.createElement("div");
  container.style.position = "fixed";
  container.style.top = "60%";
  container.style.left = "50%";
  container.style.transform = "translate(-50%, -50%)";
  container.style.background = "#222";
  container.style.padding = "20px";
  container.style.border = "2px solid #fff";
  container.style.borderRadius = "10px";
  container.style.color = "#fff";
  container.style.textAlign = "center";
  container.innerHTML = `
    <p>üèÜ ¬°Victoria! Has recogido ${bonusCollected} bonus en ${Math.floor(duration / 60)}:${('0' + (duration % 60)).slice(-2)}.</p>
    <p>Ingresa tu nombre para guardar tu r√©cord:</p>
    <input id="playerName" type="text" maxlength="20" style="padding:5px; border-radius:5px;" />
    <br><br>
    <button onclick="saveRecord()" style="padding:10px; font-size:16px;">Guardar r√©cord</button>
  `;
  document.body.appendChild(container);

  window.saveRecord = function() {
    const name = document.getElementById("playerName").value || "An√≥nimo";
    const record = { name, bonus: bonusCollected, time: duration, date };
    let records = JSON.parse(localStorage.getItem("topRecords") || "[]");
    records.push(record);
    records.sort((a, b) => b.bonus - a.bonus || a.time - b.time);
    records = records.slice(0, 50);
    localStorage.setItem("topRecords", JSON.stringify(records));
    container.remove();
    showRecords(records, duration);
  };

  function showRecords(records, duration) {
    ctx.fillStyle = "rgba(0,0,0,0.8)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#0f0";
    ctx.font = "40px Arial";
    ctx.fillText("¬°Victoria!", canvas.width / 2 - 100, 60);
    ctx.font = "16px Arial";
    ctx.fillStyle = "#fff";
    ctx.fillText("Tu tiempo: " + Math.floor(duration / 60) + ":" + ('0' + (duration % 60)).slice(-2), 40, 90);
    ctx.fillText("üèÜ Mejores 50 partidas:", 40, 120);
    for (let i = 0; i < records.length; i++) {
      const r = records[i];
      const t = Math.floor(r.time / 60) + ":" + ('0' + (r.time % 60)).slice(-2);
      ctx.fillText(`${i + 1}. ${r.name} - ${r.bonus} bonus - ${t} - ${r.date}`, 40, 150 + i * 20);
      if (150 + i * 20 > canvas.height - 20) break;
    }
    document.getElementById("restartBtn").style.display = "block";
  }

  const endTime = Date.now();
  const duration = Math.floor((endTime - startTime) / 1000);
  const date = new Date().toLocaleString();
  const record = { bonus: bonusCollected, time: duration, date };
  let records = JSON.parse(localStorage.getItem("topRecords") || "[]");
  records.push(record);
  records.sort((a, b) => b.bonus - a.bonus || a.time - b.time);
  records = records.slice(0, 50);
  localStorage.setItem("topRecords", JSON.stringify(records));
  ctx.fillStyle = "#fff";
  ctx.font = "16px Arial";
  ctx.fillText("Tu tiempo: " + Math.floor(duration / 60) + ":" + ('0' + (duration % 60)).slice(-2), canvas.width / 2 - 80, canvas.height / 2 + 60);
  ctx.fillText("üèÜ Mejores 50 partidas:", canvas.width / 2 - 100, canvas.height / 2 + 90);
  for (let i = 0; i < records.length; i++) {
    const r = records[i];
    const t = Math.floor(r.time / 60) + ":" + ('0' + (r.time % 60)).slice(-2);
    ctx.fillText(`${i + 1}. ${r.bonus} bonus - ${t} - ${r.date}`, 40, canvas.height / 2 + 110 + i * 20);
    if (canvas.height / 2 + 110 + i * 20 > canvas.height - 20) break;
  }

}

function drawVictory() {
  ctx.fillStyle = "rgba(0,0,0,0.7)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#0f0";
  ctx.font = "40px Arial";
  ctx.fillText("¬°Victoria!", canvas.width / 2 - 100, canvas.height / 2);
  ctx.font = "16px Arial";
  ctx.fillStyle = "#fff";
  ctx.fillText("Creado por Bucio", canvas.width / 2 - 80, canvas.height / 2 + 40);
  
  
  document.getElementById("restartBtn").style.display = "none";

  const endTime = Date.now();
  const duration = Math.floor((endTime - startTime) / 1000);
  const date = new Date().toLocaleString();
  const container = document.createElement("div");
  container.style.position = "fixed";
  container.style.top = "60%";
  container.style.left = "50%";
  container.style.transform = "translate(-50%, -50%)";
  container.style.background = "#222";
  container.style.padding = "20px";
  container.style.border = "2px solid #fff";
  container.style.borderRadius = "10px";
  container.style.color = "#fff";
  container.style.textAlign = "center";
  container.innerHTML = `
    <p>üèÜ ¬°Victoria! Has recogido ${bonusCollected} bonus en ${Math.floor(duration / 60)}:${('0' + (duration % 60)).slice(-2)}.</p>
    <p>Ingresa tu nombre para guardar tu r√©cord:</p>
    <input id="playerName" type="text" maxlength="20" style="padding:5px; border-radius:5px;" />
    <br><br>
    <button onclick="saveRecord()" style="padding:10px; font-size:16px;">Guardar r√©cord</button>
  `;
  document.body.appendChild(container);

  window.saveRecord = function() {
    const name = document.getElementById("playerName").value || "An√≥nimo";
    const record = { name, bonus: bonusCollected, time: duration, date };
    let records = JSON.parse(localStorage.getItem("topRecords") || "[]");
    records.push(record);
    records.sort((a, b) => b.bonus - a.bonus || a.time - b.time);
    records = records.slice(0, 50);
    localStorage.setItem("topRecords", JSON.stringify(records));
    container.remove();
    showRecords(records, duration);
  };

  function showRecords(records, duration) {
    ctx.fillStyle = "rgba(0,0,0,0.8)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#0f0";
    ctx.font = "40px Arial";
    ctx.fillText("¬°Victoria!", canvas.width / 2 - 100, 60);
    ctx.font = "16px Arial";
    ctx.fillStyle = "#fff";
    ctx.fillText("Tu tiempo: " + Math.floor(duration / 60) + ":" + ('0' + (duration % 60)).slice(-2), 40, 90);
    ctx.fillText("üèÜ Mejores 50 partidas:", 40, 120);
    for (let i = 0; i < records.length; i++) {
      const r = records[i];
      const t = Math.floor(r.time / 60) + ":" + ('0' + (r.time % 60)).slice(-2);
      ctx.fillText(`${i + 1}. ${r.name} - ${r.bonus} bonus - ${t} - ${r.date}`, 40, 150 + i * 20);
      if (150 + i * 20 > canvas.height - 20) break;
    }
    document.getElementById("restartBtn").style.display = "block";
  }

  const endTime = Date.now();
  const duration = Math.floor((endTime - startTime) / 1000);
  const date = new Date().toLocaleString();
  const record = { bonus: bonusCollected, time: duration, date };
  let records = JSON.parse(localStorage.getItem("topRecords") || "[]");
  records.push(record);
  records.sort((a, b) => b.bonus - a.bonus || a.time - b.time);
  records = records.slice(0, 50);
  localStorage.setItem("topRecords", JSON.stringify(records));
  ctx.fillStyle = "#fff";
  ctx.font = "16px Arial";
  ctx.fillText("Tu tiempo: " + Math.floor(duration / 60) + ":" + ('0' + (duration % 60)).slice(-2), canvas.width / 2 - 80, canvas.height / 2 + 60);
  ctx.fillText("üèÜ Mejores 50 partidas:", canvas.width / 2 - 100, canvas.height / 2 + 90);
  for (let i = 0; i < records.length; i++) {
    const r = records[i];
    const t = Math.floor(r.time / 60) + ":" + ('0' + (r.time % 60)).slice(-2);
    ctx.fillText(`${i + 1}. ${r.bonus} bonus - ${t} - ${r.date}`, 40, canvas.height / 2 + 110 + i * 20);
    if (canvas.height / 2 + 110 + i * 20 > canvas.height - 20) break;
  }

}

function spawnEnemy() {
  if (enemyCount < 100) {
    enemies.push({ x: Math.random() * (canvas.width - 40) + 20, y: 0, radius: 15, speed: 2 });
    enemyCount++;
  }
}

function spawnBonus() {
  if (bonusCollected + bonuses.length < bonusWords.length) {
    const word = bonusWords[bonuses.length];
    bonuses.push({
      x: Math.random() * (canvas.width - 70),
      y: 0,
      size: 70,
      speed: 1.5,
      word
    });
  }
}

function move() {
  if ((keys["ArrowLeft"] || touchLeft) && player.x > 0) player.x -= player.speed;
  if ((keys["ArrowRight"] || touchRight) && player.x < canvas.width - player.width) player.x += player.speed;
  if ((keys[" "] || touchShoot) && bullets.length < 5) {
    bullets.push({ x: player.x + player.width / 2 - 2, y: player.y, width: 4, height: 10, speed: 7 });
    playShoot();
    touchShoot = false;
  }
}

function update() {
  if (gameOver || gameWon) return;
  move();
  bullets.forEach(b => b.y -= b.speed);
  enemies.forEach(e => e.y += e.speed);
  bonuses.forEach(b => b.y += b.speed);

  bullets = bullets.filter(b => b.y > 0);
  enemies = enemies.filter(e => e.y < canvas.height);
  bonuses = bonuses.filter(b => b.y < canvas.height);

  bullets.forEach((b, bi) => {
    enemies.forEach((e, ei) => {
      const dx = b.x - e.x;
      const dy = b.y - e.y;
      if (Math.sqrt(dx*dx + dy*dy) < e.radius) {
        enemies.splice(ei, 1);
        bullets.splice(bi, 1);
        playExplosion();
      }
    });
  });

  enemies.forEach(e => {
    if (e.x > player.x && e.x < player.x + player.width && e.y + e.radius > player.y) {
      gameOver = true;
    }
  });

  bonuses.forEach((b, i) => {
    if (
      b.x < player.x + player.width &&
      b.x + b.size > player.x &&
      b.y + b.size > player.y &&
      b.y < player.y + player.height
    ) {
      bonuses.splice(i, 1);
      bonusCollected++;
    }
  });

  if (enemyCount >= 100 && enemies.length === 0) {
    gameWon = true;
  }
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  update();
  drawPlayer();
  drawBullets();
  drawEnemies();
  drawBonuses();
  drawUI();
  if (gameOver) drawGameOver();
  if (gameWon) drawVictory();
  requestAnimationFrame(gameLoop);
}

setInterval(spawnEnemy, 800);
setInterval(spawnBonus, 3000);
const startTime = Date.now();
gameLoop();
</script>
</body>
</html>
