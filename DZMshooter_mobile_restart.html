
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>DZM Shooter 2D - M√≥vil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { margin: 0; background: #000; overflow: hidden; }
    canvas { display: block; margin: 0 auto; background: #111; }
    .controls {
      position: fixed;
      bottom: 10px;
      width: 100%;
      display: flex;
      justify-content: space-around;
      z-index: 10;
    }
    .btn {
      background: rgba(255,255,255,0.2);
      border: 2px solid #fff;
      color: white;
      font-size: 20px;
      padding: 15px;
      border-radius: 10px;
      width: 80px;
      text-align: center;
      user-select: none;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<div class="controls">
  <div class="btn" id="left">‚óÄÔ∏è</div>
  <div class="btn" id="shoot">üî´</div>
  <div class="btn" id="right">‚ñ∂Ô∏è</div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight - 100;

let player = { x: canvas.width / 2 - 25, y: canvas.height - 60, width: 50, height: 20, speed: 5 };
let bullets = [];
let enemies = [];
let bonuses = [];
let enemyCount = 0;
let bonusCollected = 0;
let gameOver = false;
let gameWon = false;
let keys = {};
let touchLeft = false, touchRight = false, touchShoot = false;

const bonusWords = [
  "ADS", "ITO", "Cobertura", "Efectividad", "volumen", "Cr√©ditos", "Combos",
  "Promo mes", "PDV Grandes", "PDV Medianos", "PDV B√°sicos", "Firmas Autorizadas",
  "Medidas seguridad", "Marcas estrat√©gicas", "Cobranza al 100"
];

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

document.getElementById("left").addEventListener("touchstart", () => touchLeft = true);
document.getElementById("left").addEventListener("touchend", () => touchLeft = false);
document.getElementById("right").addEventListener("touchstart", () => touchRight = true);
document.getElementById("right").addEventListener("touchend", () => touchRight = false);
document.getElementById("shoot").addEventListener("touchstart", () => touchShoot = true);
document.getElementById("shoot").addEventListener("touchend", () => touchShoot = false);

function drawPlayer() {
  ctx.fillStyle = "#00f";
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

function drawBullets() {
  ctx.fillStyle = "#fff";
  bullets.forEach(b => ctx.fillRect(b.x, b.y, b.width, b.height));
}

function drawEnemies() {
  ctx.fillStyle = "red";
  enemies.forEach(e => {
    ctx.beginPath();
    ctx.arc(e.x, e.y, e.radius, 0, Math.PI * 2);
    ctx.fill();
  });
}

function drawBonuses() {
  ctx.fillStyle = "yellow";
  ctx.font = "12px Arial";
  bonuses.forEach(b => {
    ctx.fillRect(b.x, b.y, b.size, b.size);
    ctx.fillStyle = "black";
    ctx.fillText(b.word, b.x + 2, b.y + b.size / 2);
    ctx.fillStyle = "yellow";
  });
}

function spawnEnemy() {
  if (enemyCount < 100) {
    enemies.push({ x: Math.random() * (canvas.width - 40) + 20, y: 0, radius: 15, speed: 2 });
    enemyCount++;
  }
}

function spawnBonus() {
  if (bonusCollected + bonuses.length < bonusWords.length) {
    const word = bonusWords[bonuses.length];
    bonuses.push({
      x: Math.random() * (canvas.width - 70),
      y: 0,
      size: 70,
      speed: 1.5,
      word
    });
  }
}

function move() {
  if ((keys["ArrowLeft"] || touchLeft) && player.x > 0) player.x -= player.speed;
  if ((keys["ArrowRight"] || touchRight) && player.x < canvas.width - player.width) player.x += player.speed;
  if ((keys[" "] || touchShoot) && bullets.length < 5) {
    bullets.push({ x: player.x + player.width / 2 - 2, y: player.y, width: 4, height: 10, speed: 7 });
    touchShoot = false; // para que dispare una sola vez
  }
}

function update() {
  if (gameOver || gameWon) return;
  move();
  bullets.forEach(b => b.y -= b.speed);
  enemies.forEach(e => e.y += e.speed);
  bonuses.forEach(b => b.y += b.speed);

  bullets = bullets.filter(b => b.y > 0);
  enemies = enemies.filter(e => e.y < canvas.height);
  bonuses = bonuses.filter(b => b.y < canvas.height);

  bullets.forEach((b, bi) => {
    enemies.forEach((e, ei) => {
      const dx = b.x - e.x;
      const dy = b.y - e.y;
      if (Math.sqrt(dx*dx + dy*dy) < e.radius) {
        enemies.splice(ei, 1);
        bullets.splice(bi, 1);
      }
    });
  });

  enemies.forEach(e => {
    if (
      e.x > player.x &&
      e.x < player.x + player.width &&
      e.y + e.radius > player.y
    ) {
      gameOver = true;
    }
  });

  bonuses.forEach((b, i) => {
    if (
      b.x < player.x + player.width &&
      b.x + b.size > player.x &&
      b.y + b.size > player.y &&
      b.y < player.y + player.height
    ) {
      bonuses.splice(i, 1);
      bonusCollected++;
    }
  });

  if (enemyCount >= 100 && enemies.length === 0) {
    gameWon = true;
    updateHighScore(bonusCollected);
  }
}

function drawUI() {
  ctx.fillStyle = "#fff";
  ctx.font = "14px Arial";
  ctx.fillText("Enemigos eliminados: " + (enemyCount - enemies.length) + " / 100", 10, 20);
  ctx.fillText("Bonus recogidos: " + bonusCollected + " / " + bonusWords.length, 10, 40);
}

function drawGameOver() {
  ctx.fillStyle = "rgba(0,0,0,0.7)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#f00";
  ctx.font = "40px Arial";
  ctx.fillText("¬°Game Over!", canvas.width / 2 - 120, canvas.height / 2);
}

function drawVictory() {
  ctx.fillStyle = "rgba(0,0,0,0.7)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#0f0";
  ctx.font = "40px Arial";
  ctx.fillText("¬°Victoria!", canvas.width / 2 - 100, canvas.height / 2);
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  update();
  drawPlayer();
  drawBullets();
  drawEnemies();
  drawBonuses();
  drawUI();
  if (gameOver) drawGameOver();
  if (gameWon) drawVictory();
  requestAnimationFrame(gameLoop);
}

setInterval(spawnEnemy, 800);
setInterval(spawnBonus, 3000);
gameLoop();
</script>

<button id="restartBtn" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
padding:20px; font-size:20px; background:#fff; border-radius:10px; border:2px solid #000; z-index:20;">
üîÑ Jugar de nuevo
</button>
<script>
document.getElementById("restartBtn").addEventListener("click", () => {
  location.reload();
});

<script>
let highScore = localStorage.getItem("highScoreMobile") || 0;
function updateHighScore(score) {
  if (score > highScore) {
    highScore = score;
    localStorage.setItem("highScoreMobile", score);
  }
}
</script>
</script>
</body>

</html>
